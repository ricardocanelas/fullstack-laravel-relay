(window.webpackJsonpweb=window.webpackJsonpweb||[]).push([[0],{161:function(e,n,t){"use strict";var a=function(){var e=[{kind:"LinkedField",alias:null,name:"me",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"email",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"authContextQuery",type:"Query",metadata:null,argumentDefinitions:[],selections:e},operation:{kind:"Operation",name:"authContextQuery",argumentDefinitions:[],selections:e},params:{operationKind:"query",name:"authContextQuery",id:null,text:"query authContextQuery {\n  me {\n    id\n    email\n  }\n}\n",metadata:{}}}}();a.hash="ed310b0b78945816295626ccf7d1565b",e.exports=a},162:function(e,n,t){"use strict";var a=function(){var e=[{kind:"LocalArgument",name:"data",type:"LoginInput",defaultValue:null}],n=[{kind:"LinkedField",alias:null,name:"login",storageKey:null,args:[{kind:"Variable",name:"data",variableName:"data"}],concreteType:"AuthPayload",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"access_token",args:null,storageKey:null},{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"email",args:null,storageKey:null}]}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"authContextLoginMutation",type:"Mutation",metadata:null,argumentDefinitions:e,selections:n},operation:{kind:"Operation",name:"authContextLoginMutation",argumentDefinitions:e,selections:n},params:{operationKind:"mutation",name:"authContextLoginMutation",id:null,text:"mutation authContextLoginMutation(\n  $data: LoginInput\n) {\n  login(data: $data) {\n    access_token\n    user {\n      id\n      email\n    }\n  }\n}\n",metadata:{}}}}();a.hash="0dde6ec78ec603fb01848cd465e18541",e.exports=a},163:function(e,n,t){"use strict";var a=function(){var e=[{kind:"LinkedField",alias:null,name:"logout",storageKey:null,args:null,concreteType:"LogoutResponse",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"message",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"authContextLogoutMutation",type:"Mutation",metadata:null,argumentDefinitions:[],selections:e},operation:{kind:"Operation",name:"authContextLogoutMutation",argumentDefinitions:[],selections:e},params:{operationKind:"mutation",name:"authContextLogoutMutation",id:null,text:"mutation authContextLogoutMutation {\n  logout {\n    message\n  }\n}\n",metadata:{}}}}();a.hash="b6e1eeddfa78acdd20e2f34d842e80df",e.exports=a},164:function(e,n,t){"use strict";var a=function(){var e=[{kind:"LocalArgument",name:"first",type:"Int!",defaultValue:null}],n=[{kind:"LinkedField",alias:null,name:"users",storageKey:null,args:[{kind:"Variable",name:"first",variableName:"first"}],concreteType:"UserConnection",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"edges",storageKey:null,args:null,concreteType:"UserEdge",plural:!0,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"email",args:null,storageKey:null}]},{kind:"ScalarField",alias:null,name:"cursor",args:null,storageKey:null}]}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"UsersPageQuery",type:"Query",metadata:null,argumentDefinitions:e,selections:n},operation:{kind:"Operation",name:"UsersPageQuery",argumentDefinitions:e,selections:n},params:{operationKind:"query",name:"UsersPageQuery",id:null,text:"query UsersPageQuery(\n  $first: Int!\n) {\n  users(first: $first) {\n    edges {\n      node {\n        id\n        name\n        email\n      }\n      cursor\n    }\n  }\n}\n",metadata:{}}}}();a.hash="76e77fe07733952a4c7c1bf208216fc1",e.exports=a},165:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),l=t(85),o=t.n(l),i=(t(95),t(12)),u=t(17),s=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Index"),r.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),r.a.createElement("p",null,"Click here to ",r.a.createElement(i.b,{to:"/users"},"check all users")," ",r.a.createElement("small",null,"(if you're already logged)")))},c=t(31),m=t(22),d=t(27),p=t(56),g=t(32),f=t.n(g),y=r.a.createContext(),b=function(){return t(161)},E=function(){return t(162)},h=function(){return t(163)};function v(){var e=r.a.useContext(y);if(void 0===e)throw new Error("useAuth must be used within a AuthProvider");return e}function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}var O=function(e){var n=r.a.useState({email:"feest.luella@example.net",password:"password1"}),t=Object(m.a)(n,2),a=t[0],l=t[1],o=v(),i=o.user,u=o.login,s=o.loginProps,d=s.loading,p=s.error,g=function(e){return function(n){l(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(t,!0).forEach(function(n){Object(c.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},a,Object(c.a)({},e,n.target.value)))}};console.log(e);return p&&(console.log("AAAAHHHH!!!"),console.log(p.source.errors[0].message),console.log(typeof p),console.log(JSON.stringify(p))),r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),e.location.state&&e.location.state.from&&r.a.createElement("div",null,r.a.createElement("div",{className:"alert"},"To access the url ",r.a.createElement("span",{className:"bold"},e.location.state.from.pathname," "),"you need to be log in.")),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),d||u(a.email,a.password)}},i&&r.a.createElement("div",null,"You're already logged"),!i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"E-mail",r.a.createElement("input",{value:a.email,onChange:g("email"),disabled:d})),r.a.createElement("label",null,"Password",r.a.createElement("input",{type:"password",value:a.password,onChange:g("password"),disabled:d})),r.a.createElement("button",{type:"submit",disabled:d},"Login"),p&&r.a.createElement("span",{className:"message"},"The user credentials were incorrect."),d&&r.a.createElement("span",{className:"message"},"Checking credential..."))))},w=function(){return t(164)},j=function(){var e=Object(d.useQuery)({query:w,variables:{first:50}}),n=e.props,t=e.error;return r.a.createElement("div",null,r.a.createElement("h1",null,"All Users"),t&&r.a.createElement("div",null,"Ops! There's an error"),!n&&r.a.createElement("div",null,"Loading.."),n&&n.users&&n.users.edges.map(function(e){return r.a.createElement("li",{key:e.node.id},e.node.name," / ",e.node.email)}))},x=t(88);var P=function(e){var n=e.component,t=Object(x.a)(e,["component"]),a=v().user;return r.a.createElement(u.b,Object.assign({},t,{render:function(e){return a?r.a.createElement(n,e):r.a.createElement(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},F=function(){var e=v(),n=e.user,t=e.logout;return r.a.createElement("div",null,r.a.createElement("nav",null,n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(i.b,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/users"},"Users")),r.a.createElement("li",{className:"btn btn-link",onClick:t},"Logout"),r.a.createElement("div",{className:"pull-right"},"User: ",JSON.stringify(n))),!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(i.b,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/login"},"Login")))))},L=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(F,null),r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0,component:s}),r.a.createElement(u.b,{path:"/login/",component:O}),r.a.createElement(P,{path:"/users/",component:j})))},C=function(){return v().firstAttemptFinished?r.a.createElement(L,null):r.a.createElement("div",null,"Checking authentication..")},S=t(5),K=t(89),D=t.n(K);function q(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?q(t,!0).forEach(function(n){Object(c.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var N="http://localhost:8000/graphql";function U(){var e=f.a.get("token");return console.log("injectAuthorization",e),null===e||void 0===e?{}:{Authorization:"Bearer ".concat(e)}}var M=new S.Environment({network:S.Network.create(D.a.wrapFetch(function(e,n){return fetch(N,{method:"POST",headers:A({Accept:"application/json","Content-Type":"application/json"},U()),body:JSON.stringify({query:e.text,variables:n})}).then(function(e){return e.json()})},function(){return""})),store:new S.Store(new S.RecordSource)});o.a.render(r.a.createElement(d.RelayEnvironmentProvider,{environment:M},r.a.createElement(function(e){var n=r.a.useState(!1),t=Object(m.a)(n,2),a=t[0],l=t[1],o=r.a.useState(null),i=Object(m.a)(o,2),u=i[0],s=i[1],c=Object(d.useQuery)({query:b,variables:{}}).props,g=Object(p.useMutation)(E,{onCompleted:function(e){f.a.set("token",e.login.access_token,{expires:7}),s(e.login.user)},onError:function(){}}),v=Object(m.a)(g,2),k=v[0],O=v[1],w=Object(p.useMutation)(h),j=Object(m.a)(w,1)[0],x=r.a.useCallback(function(){j({variables:{}}),f.a.remove("token"),s(null)},[j]),P=r.a.useCallback(function(e,n){return k({variables:{data:{username:e,password:n}}})},[k]);return r.a.useLayoutEffect(function(){c&&(a||(l(!0),s(c.me)))},[c,a]),r.a.createElement(y.Provider,Object.assign({value:{user:u,login:P,loginProps:O,logout:x,firstAttemptFinished:a}},e))},null,r.a.createElement(i.a,null,r.a.createElement(C,null)))),document.getElementById("root"))},90:function(e,n,t){e.exports=t(165)},95:function(e,n,t){}},[[90,1,2]]]);
//# sourceMappingURL=main.bd48ce35.chunk.js.map